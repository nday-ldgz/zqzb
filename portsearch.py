#! /usr/bin/python3

import sys

print('''
                   _                           _     
                  | |                         | |    
  _ __   ___  _ __| |_ ___  ___  __ _ _ __ ___| |__  
 | '_ \ / _ \| '__| __/ __|/ _ \/ _` | '__/ __| '_ \ 
 | |_) | (_) | |  | |_\__ \  __/ (_| | | | (__| | | |
 | .__/ \___/|_|   \__|___/\___|\__,_|_|  \___|_| |_|
 | |                                                 
 |_| 

>>微信公众号：漏洞感知
>>>QQ交流群：801830727
>>>>用法：portsearch.py 445
>>>>>说明：方便查询默认端口应用协议的小工具
>>>>>>规则数：200条

''')

try:
    strport = sys.argv[1]
    portdata = {
    '7':'Echo',
    '11':'Systat',
    '13 ':'Daytime',
    '15':'Netstat',
    '17':'Quote of the day',
    '19':'Character generator',
    '21':'FTP',
    '22':'SSH',
    '23':'Telnet',
    '25':'SMTP',
    '26':'SSH',
    '37':'rdate',
    '49':'TACACS+',
    '53':'DNS',
    '67':'DHCP',
    '69':'TFTP, BitTorrent',
    '70':'Gopher',
    '79':'Finger',
    '80':'HTTP, malware',
    '81':'HTTP, malware',
    '82':' HTTP, malware',
    '83':'HTTP',
    '84':'HTTP',
    '88':'Kerberos',
    '102':'Siemens S7',
    '104':'DICOM',
    '110':'POP3',
    '111':'Portmapper',
    '113':'identd',
    '119 ':'NNTP',
    '123':'NTP',
    '129':'Password generator protocol',
    '137':'NetBIOS',
    '143':'IMAP',
    '161':'SNMP',
    '175':'IBM Network Job Entry',
    '179':'BGP',
    '195':'TA14-353a',
    '311':'OS X Server Manager',
    '389':'LDAP,CLDAP',
    '443':'HTTPS,QUIC',
    '444':'TA14-353a, Dell SonicWALL',
    '445':'SMB',
    '465':'SMTPS',
    '500':'IKE (VPN)',
    '502':'Modbus',
    '503':'Modbus',
    '515':'Line Printer Daemon',
    '520':'RIP',
    '523':'IBM DB2',
    '554':'RTSP',
    '587':'SMTP mail submission',
    '623':'IPMI',
    '626':'OS X serialnumbered',
    '636':'LDAPS',
    '666':'Telnet',
    '771':'Realport',
    '789':'Redlion Crimson3',
    '873':'rsync',
    '902':'VMWare authentication',
    '992':'Telnet (secure)',
    '993':'IMAP with SSL',
    '995':'POP3 with SSL',
    '1010':'malware',
    '1023':'Telnet',
    '1025':'Kamstrup',
    '1099':'Java RMI',
    '1177':'malware',
    '1200':'Codesys',
    '1234':'udpxy',
    '1434':'MS-SQL monitor',
    '1515':'malware',
    '1521':'Oracle TNS',
    '1604':'Citrix, malware',
    '1723':'PPTP',
    '1741':'CiscoWorks',
    '1833':'MQTT',
    '1900':'UPnP',
    '1911':'Niagara Fox',
    '4444':'malware',
    '4500':'IKE NAT-T (VPN)',
    '4567':'Modem web interface',
    '4664':'Qasar',
    '4730':'Gearman',
    '4782':'Qasar',
    '4800':'Moxa Nport',
    '4840':'OPC UA',
    '4911':'Niagara Fox with SSL',
    '4949':'Munin',
    '5006':'MELSEC-Q',
    '5007':'MELSEC-Q',
    '5008 ':'NetMobility',
    '5009':'Apple Airport Administration',
    '5060':'SIP',
    '5094':'HART-IP',
    '5222':'XMPP',
    '5269':'XMPP Server-to-Server',
    '5353':'mDNS',
    '5357':'Microsoft-HTTPAPI/2.0',
    '5432':'PostgreSQL',
    '5577':'Flux LED',
    '5601':'Kibana',
    '5632':'PCAnywhere',
    '5672':'RabbitMQ',
    '5900':'VNC',
    '5901':'VNC',
    '5938':'TeamViewer',
    '5984':'CouchDB',
    '6000':'X11',
    '6001':'X11',
    '6379':'Redis',
    '6666':'Voldemort database, malware',
    '6667':'IRC',
    '6881':'BitTorrent DHT',
    '6969':'TFTP, BitTorrent',
    '7218':'Sierra wireless (Telnet)',
    '7474':'Neo4j database',
    '7548':'CWMP (HTTPS)',
    '7777':'Oracle',
    '8008':'Chromecast',
    '8009':'Vizio HTTPS',
    '8010':'Intelbras DVR',
    '8060':'Roku web interface',
    '8069':'OpenERP',
    '8087':'Riak',
    '8090':'Insteon HUB',
    '8099':'Yahoo SmartTV',
    '8112':'Deluge (HTTP)',
    '8126':'StatsD',
    '8139':'Puppet agent',
    '8140':'Puppet master',
    '8181':'GlassFish Server (HTTPS)',
    '8333':'Bitcoin',
    '8334':'Bitcoin node dashboard (HTTP)',
    '8443':'HTTPS',
    '8554':'RTSP',
    '8800':'HTTP',
    '8880':'Websphere SOAP',
    '8888':'HTTP, Andromouse',
    '8889':'SmartThings Remote Access',
    '9000':'Vizio HTTPS',
    '9001':'Tor OR',
    '9002':'Tor OR',
    '9009':'Julia',
    '9042':'Cassandra CQL',
    '9051':'Tor Control',
    '9100':'Printer Job Language',
    '9151':'Tor Control',
    '9160':'Apache Cassandra',
    '9191':'Sierra wireless (HTTP)',
    '9418':'Git',
    '9443':'Sierra wireless (HTTPS)',
    '9595':'LANDesk Management Agent',
    '9600':'OMRON',
    '9633':'DarkTrack RAT',
    '9869':'OpenNebula',
    '10001':'Automated Tank Gauge,Ubiquiti',
    '10243':'Microsoft-HTTPAPI/2.0',
    '10554':'RTSP',
    '11211':'Memcache',
    '12345':'malware,Sierra wireless (Telnet)',
    '17000':'Bose SoundTouch',
    '17185':'VxWorks WDBRPC',
    '11300':'Beanstalk',
    '13579':'Media player classic web interface',
    '14147':'Filezilla FTP',
    '16010':'Apache Hbase',
    '16992':'Intel AMT',
    '16993':'Intel AMT',
    '18245':'General Electric SRTP',
    '20000':'DNP3',
    '20547':'ProconOS',
    '21025':'Starbound',
    '21379':'Matrikon OPC',
    '23023':'Telnet',
    '23424':'Serviio',
    '25105':'Insteon Hub',
    '25565':'Minecraft',
    '27015':'Steam A2S server query, Steam RCon',
    '27016':'Steam A2S server query',
    '27017':'MongoDB',
    '28015':'Steam A2S server query',
    '28017':'MongoDB (HTTP)',
    '30313':'Gardasoft Lighting',
    '30718':'Lantronix Setup',
    '32400':'Plex',
    '37777':'Dahuva DVR',
    '44818':'EtherNet/IP',
    '47808':'Bacnet',
    '49152':'Supermicro (HTTP)',
    '49153':'WeMo Link',
    '50070':'HDFS Namenode',
    '51106':'Deluge (HTTP)',
    '53413':'Netis backdoor',
    '54138':'Toshiba PoS',
    '55443':'McAfee',
    '55553':'Metasploit',
    '55554':'Metasploit',
    '62078':'Apple iDevice',
    '64738':'Mumble',

    }

    print('[+]请参考查询结果:',portdata.get(strport))
    
except:
    print('[*]usage: portsearch.py 445')